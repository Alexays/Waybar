dist: xenial
os: linux
language: python
sudo: required

python: 3.6

addons:
    apt:
        sources:
            - ubuntu-toolchain-r-test
        packages:
            - gcc-7
            - g++-7
            - libinput10
            - libinput-dev
            - wayland-protocols
            - libwayland-client0
            - libwayland-cursor0
            - libwayland-bin

matrix:
    include:
        - env: CC=gcc-7 CXX=g++-7
        - env: CC=clang CXX=clang++

before_install:
    - git clone https://github.com/swaywm/wlroots subprojects/wlroots
    - wget http://http.us.debian.org/debian/pool/main/w/wayland/libwayland-dev_1.16.0-1_i386.deb
    - sudo dpkg -i libwayland-dev_1.16.0-1_i386.deb

install:
    - wget https://github.com/ninja-build/ninja/releases/download/v1.8.2/ninja-linux.zip
    - mkdir -p "$HOME/.local/bin"
    - unzip ninja-linux.zip -d ${HOME}/.local/bin
    - export PATH="$HOME/.local/bin:$PATH"
    - pip install meson

before_script:
    - mkdir build

script:
    - meson build
    - ninja -C build